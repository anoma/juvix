RSUBDIRS = juvix

CC = clang
CFLAGS = -std=c11 -W -Wall -Wno-unused-parameter -Werror
LIBTOOL = llvm-ar
LIBFLAGS = csru

LIB = juvix

RELEASE CFLAGS = -DNDEBUG
DEBUG CFLAGS = -DDEBUG

WASM32+RELEASE BUILDDIR = _build.wasm32
WASM32+DEBUG BUILDDIR = _build.wasm32-debug
WASM32 CFLAGS = -Os --target=wasm32 -DARCH_WASM32 -DAPI_NONE

WASM32-WASI+RELEASE BUILDDIR = _build.wasm32-wasi
WASM32-WASI+DEBUG BUILDDIR = _build.wasm32-wasi-debug
WASM32-WASI CFLAGS = -Os --target=wasm32-wasi -DARCH_WASM32 -DAPI_WASI

NATIVE32+RELEASE BUILDDIR = _build.native32
NATIVE32+DEBUG BUILDDIR = _build.native32-debug
NATIVE32 CFLAGS = -O3 -m32 -DARCH_NATIVE32 -DAPI_LIBC

NATIVE64+RELEASE BUILDDIR = _build.native64
NATIVE64+DEBUG BUILDDIR = _build.native64-debug
NATIVE64 CFLAGS = -O3 -m64 -DARCH_NATIVE64 -DAPI_LIBC

X86_32+RELEASE BUILDDIR = _build.x86_32
X86_32+DEBUG BUILDDIR = _build.x86_32-debug
X86_32 CFLAGS = -O3 -fomit-frame-pointer --target=i386 -DARCH_NATIVE32 -DAPI_LIBC

ASM BUILDDIR = _build.asm
ASM CFLAGS = -S -O0 --target=i386 -DARCH_NATIVE32 -DAPI_LIBC

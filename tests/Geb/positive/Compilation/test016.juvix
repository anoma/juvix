-- local functions with free variables
module test016;

open import Stdlib.Prelude;
open import Stdlib.Data.Nat.Ord;

terminating
f : Nat → Nat → Nat;
f x :=
    let g : Nat → Nat; g y := x + y in
    if (x == 0)
       (f 10)
       (if (x < 10)
           λ{y := g (f (sub x 1) y)}
           g);

g : Nat → (Nat → Nat) → Nat;
g x h := x + h x;

terminating
h : Nat → Nat;
h zero := 0;
h (suc x) := g x h;

main : Nat;
main := f 100 500 + f 5 0 + f 5 5 + h 10 + g 10 h + g 3 (f 10);

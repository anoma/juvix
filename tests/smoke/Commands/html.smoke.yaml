working-directory: ./../../../examples/

tests:
  - name: html-stdout
    command:
      shell:
        - bash
      script: |
        cd milestone/ValidityPredicates
        juvix html SimpleFungibleToken.juvix --only-source
        cat html/SimpleFungibleToken.html
    stdout:
      contains:
        <!DOCTYPE HTML>
    exit-status: 0

  - name: output-dir
    command:
      shell:
        - bash
      script: |
        rm -rf html
        juvix html milestone/ValidityPredicates/SimpleFungibleToken.juvix --only-source --output-dir=html --non-recursive
        [ -d html/assets ]
        [ -f html/SimpleFungibleToken.html ]
    stdout:
      matches: |
        Copying assets files to .*
        Writing .*SimpleFungibleToken.html
    exit-status: 0

  - name: recursive-generation
    command:
      shell:
        - bash
      script: |
        rm -rf html
        juvix html milestone/ValidityPredicates/SimpleFungibleToken.juvix --only-source --output-dir=html
        (ls html | wc -l)
        cd html
        [ -f Stdlib.Data.Ord.html ]
        [ -f Stdlib.Data.String.html ]
        [ -f Stdlib.Data.Nat.html ]
        [ -f Stdlib.System.IO.html ]
        [ -f Stdlib.Function.html ]
        [ -f Stdlib.Data.List.html ]
        [ -f Stdlib.Data.String.Ord.html ]
        [ -f Stdlib.Data.Product.html ]
        [ -f Data.Int.Ops.html ]
        [ -f Stdlib.Data.Maybe.html ]
        [ -f Data.Int.html ]
        [ -f Stdlib.Data.Bool.html ]
        [ -f Stdlib.Prelude.html ]
        [ -f Anoma.Base.html ]
        [ -f SimpleFungibleToken.html ]
        [ -f assets/css/source-ayu-light.css ]
        [ -f assets/css/source-nord.css ]
        [ -f assets/images/tara-magicien.png ]
        [ -f assets/images/tara-seating.svg ]
        [ -f assets/images/tara-smiling.png ]
        [ -f assets/images/tara-smiling.svg ]
        [ -f assets/images/tara-teaching.png ]
        [ -f assets/images/tara-teaching.svg ]
        [ -f assets/js/highlight.js ]
        [ -f assets/js/tex-chtml.js ]
    stdout:
      contains: |
        SimpleFungibleToken.html
    exit-status: 0


  - name: judoc-assets
    command:
      shell:
        - bash
      script: |
        rm -rf html
        juvix html milestone/ValidityPredicates/SimpleFungibleToken.juvix --output-dir=html
        (ls html | wc -l)
        cd html
        [ -f Stdlib.Data.Ord.html ]
        [ -f Stdlib.Data.String.html ]
        [ -f Stdlib.Data.Nat.html ]
        [ -f Stdlib.System.IO.html ]
        [ -f Stdlib.Function.html ]
        [ -f Stdlib.Data.List.html ]
        [ -f Stdlib.Data.String.Ord.html ]
        [ -f Stdlib.Data.Product.html ]
        [ -f Data.Int.Ops.html ]
        [ -f Stdlib.Data.Maybe.html ]
        [ -f Data.Int.html ]
        [ -f Stdlib.Data.Bool.html ]
        [ -f Stdlib.Prelude.html ]
        [ -f Anoma.Base.html ]
        [ -f SimpleFungibleToken.html ]
        [ -f assets/css/source-ayu-light.css ]
        [ -f assets/css/source-nord.css ]
        [ -f assets/css/linuwial.css ]
        [ -f assets/images/tara-magicien.png ]
        [ -f assets/images/tara-seating.svg ]
        [ -f assets/images/tara-smiling.png ]
        [ -f assets/images/tara-smiling.svg ]
        [ -f assets/images/tara-teaching.png ]
        [ -f assets/images/tara-teaching.svg ]
        [ -f assets/js/highlight.js ]
        [ -f assets/js/tex-chtml.js ]
    stdout:
      contains: |
        SimpleFungibleToken.html
    exit-status: 0

  - name: non-recursive-generation
    command:
      shell:
        - bash
      script: |
        rm -rf html
        juvix html milestone/ValidityPredicates/SimpleFungibleToken.juvix --output-dir=html --non-recursive
        (ls html | wc -l)
        cd html
        [ -d assets ]
        [ -f SimpleFungibleToken.html ]
    stdout:
      matches: |
        Copying assets files to .*
        Writing .*SimpleFungibleToken.html
        4
    exit-status: 0

  - name: non-recursive-generation-only-source
    command:
      shell:
        - bash
      script: |
        rm -rf html
        juvix html milestone/ValidityPredicates/SimpleFungibleToken.juvix --output-dir=html --non-recursive --only-source
        (ls html | wc -l)
        cd html
        [ -d assets/ ]
        [ -f SimpleFungibleToken.html ]
    stdout:
      matches: |
        Copying assets files to .*
        Writing .*SimpleFungibleToken.html
        2
    exit-status: 0

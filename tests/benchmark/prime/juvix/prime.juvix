-- Compute the Nth prime
module prime;
  open import Stdlib.Prelude;
  open import Stdlib.Data.Nat.Ord;

  checkDivisible : Nat → List Nat → Bool;
  checkDivisible p nil := false;
  checkDivisible p (h :: t) := if
    (mod p h == 0)
    true
    (checkDivisible p t);

  terminating
  go : Nat → Nat → List Nat → Nat;
  go n p lst := if
    (n == 0)
    (head lst)
    (if
      (checkDivisible p lst)
      (go n (p + 1) lst)
      (go (sub n 1) (p + 1) (p :: lst)));

  prime : Nat → Nat;
  prime n := go n 2 nil;

  main : IO;
  main := printNatLn (prime 16384);
end;

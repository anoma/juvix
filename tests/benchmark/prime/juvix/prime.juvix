-- Compute the Nth prime
module prime;

import Stdlib.Prelude open;
import Stdlib.Data.Nat.Ord open;

checkDivisible : Nat → List Nat → Bool
  | p nil := false
  | p (h :: t) := if (mod p h == 0) true (checkDivisible p t);

terminating
go : Nat → Nat → List Nat → Nat
  | n p lst :=
    if
      (n == 0)
      (head lst)
      (if
        (checkDivisible p lst)
        (go n (p + 1) lst)
        (go (sub n 1) (p + 1) (p :: lst)));

prime : Nat → Nat
  | n := go n 2 nil;

main : IO := printNatLn (prime 16384);

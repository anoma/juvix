-- count combinations of numbers 1 to N having sum N
module combinations;
  open import Stdlib.Prelude;
  open import Stdlib.Data.Nat.Ord;

  terminating
  go : Nat → Nat → Nat;
  go _ zero := 1;
  go zero _ := 0;
  go n s := if
    (s < n)
    (go (sub n 1) s)
    (go n (sub s n) + go (sub n 1) s);

  combinations : Nat → Nat;
  combinations n := go n n;

  main : IO;
  main := printNatLn (combinations 100);
end;

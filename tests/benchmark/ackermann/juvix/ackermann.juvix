-- Ackermann function (higher-order definition)
module ackermann;
  open import Stdlib.Prelude;
  open import Stdlib.Data.Nat.Ord;

  iter : {A : Type} → (A → A) → Nat → A → A;
  iter f zero := id;
  iter f (suc n) := f ∘ iter f n;

  step : (Nat → Nat) → Nat → Nat;
  step f n := iter f (suc n) 1;

  ackermann : Nat → Nat → Nat;
  ackermann m := iter step m suc;

  main : IO;
  main := printNatLn (ackermann 3 11);
end;

-- fold a list of N integers
module fold;
  open import Stdlib.Prelude;
  open import Stdlib.Data.Nat.Ord;

  plusMod : Nat → Nat → Nat;
  plusMod x y := mod (x + y) 268435456;

  run : Nat → Nat → List Nat → Nat;
  run zero acc lst := foldl plusMod acc lst;
  run (suc n) acc lst := run n (foldl plusMod acc lst) lst;

  gen : Nat → List Nat → List Nat;
  gen zero acc := acc;
  gen (suc n) acc := gen n (suc n :: acc);

  main : IO;
  main := printNatLn (run 1000 0 (gen 100000 nil));
end;

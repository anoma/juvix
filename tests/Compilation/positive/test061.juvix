--- Traits
module test061;

import Stdlib.Prelude open hiding {Show; mkShow; show};

trait
type Show A :=
  mkShow {
    show : A → String
  };

instance
showBoolI : Show Bool := mkShow (show := λ{x := if x "true" "false"});

showNat : Nat → String
  | zero := "zero"
  | (suc n) := "suc (" ++str showNat n ++str ")";

instance
showNatI : Show Nat := mkShow (show := showNat);

f {A} : {{Show A}} → A → String
  | x := Show.show x;

main : IO :=
  printStringLn (Show.show true) >>
  printStringLn (f false) >>
  printStringLn (Show.show 3);

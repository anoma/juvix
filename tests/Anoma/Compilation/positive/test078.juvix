module test078;

import Stdlib.Prelude open;
import Stdlib.Debug.Trace open;

builtin bytearray
axiom ByteArray : Type;

builtin bytearray-from-list-byte
axiom mkByteArray : List Byte -> ByteArray;

builtin bytearray-length
axiom byteArrayLength : ByteArray -> Nat;

builtin anoma-sign
axiom anomaSign : {A : Type} -> A -> ByteArray -> ByteArray;

builtin anoma-verify-with-message
axiom anomaVerifyWithMessage : {A : Type} -> ByteArray -> ByteArray -> Maybe A;

privKey : ByteArray :=
  mkByteArray
    [
      0x24;
      0xbd;
      0x9b;
      0x1e;
      0x60;
      0x29;
      0x76;
      0x7b;
      0x76;
      0xa4;
      0x8c;
      0x24;
      0x96;
      0xcc;
      0xf9;
      0x81;
      0x6e;
      0x26;
      0xa1;
      0x7c;
      0xfb;
      0xbc;
      0xb8;
      0x33;
      0x1;
      0x71;
      0x66;
      0xe3;
      0x35;
      0x68;
      0x4a;
      0x22;
      0xef;
      0x84;
      0x90;
      0xee;
      0x90;
      0x3e;
      0x7c;
      0x1d;
      0x9;
      0x87;
      0xf8;
      0xf7;
      0xe2;
      0x23;
      0xc2;
      0xde;
      0x4e;
      0x4a;
      0x17;
      0xca;
      0x29;
      0x75;
      0x5;
      0x80;
      0xa6;
      0x67;
      0xc;
      0xcd;
      0xdb;
      0xae;
      0xc5;
      0xc3;
    ];

pubKey : ByteArray :=
  mkByteArray
    [
      0xef;
      0x84;
      0x90;
      0xee;
      0x90;
      0x3e;
      0x7c;
      0x1d;
      0x9;
      0x87;
      0xf8;
      0xf7;
      0xe2;
      0x23;
      0xc2;
      0xde;
      0x4e;
      0x4a;
      0x17;
      0xca;
      0x29;
      0x75;
      0x5;
      0x80;
      0xa6;
      0x67;
      0xc;
      0xcd;
      0xdb;
      0xae;
      0xc5;
      0xc3;
    ];

main (input : List Nat) : List Nat :=
  let
    signedMessage : ByteArray := anomaSign input privKey;
  in fromMaybe [] <| anomaVerifyWithMessage signedMessage pubKey;
